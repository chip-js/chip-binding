var Binding,Controller,Filter,Observer,Walker,addReferences,addThis,argSeparator,bindingSort,chainLink,chainLinks,continuation,currentIndex,currentReference,diff,div,emptyQuoteExpr,expression,filterAttributes,finishedChain,getBoundAttributes,getFunctionCall,ignore,initParse,invertedExpr,keyCode,keyCodes,name,nextChain,parens,parseChain,parseExpr,parseFilters,parseFunction,parsePart,parsePropertyChains,pipeExpr,prepareScope,propExpr,pullOutStrings,putInStrings,quoteExpr,referenceCount,setterExpr,sortAttributes,splitLinks,strings,swapPlaceholder,urlExp,slice1=[].slice,hasProp={}.hasOwnProperty;Observer=function(){function e(e,n,t){this.getter=e,this.callback=n,this.oldValue=t}return e.prototype.skipNextSync=function(){return this.skip=!0},e.prototype.sync=function(){var e,n;if(n=this.getter(),this.skip)delete this.skip;else{if(e=diff.values(n,this.oldValue),!e)return;Array.isArray(e)?this.callback(n,this.oldValue,e):this.callback(n,this.oldValue)}return this.oldValue=diff.clone(n)},e.prototype.close=function(){return e.remove(this)},e.observers=[],e.callbacks=[],e.listeners=[],e.add=function(n,t,r){var i,o;return"function"==typeof t&&(r=t,t=!1),o=n(),i=new e(n,r,diff.clone(o)),this.observers.push(i),t||r(o),i},e.remove=function(e){var n;return n=this.observers.indexOf(e),-1!==n?(this.observers.splice(n,1),!0):!1},e.syncing=!1,e.rerun=!1,e.cycles=0,e.max=10,e.timeout=null,e.sync=function(e){var n,t,r,i;if("function"==typeof e&&this.afterSync(e),this.syncing)return this.rerun=!0,!1;for(this.syncing=!0,this.rerun=!0,this.cycles=0;this.rerun;){if(++this.cycles===this.max)throw"Infinite observer syncing, an observer is calling Observer.sync() too many times";this.rerun=!1;for(var o=0;o<this.observers.length;o++)this.observers[o].sync()}for(;this.callbacks.length;)this.callbacks.shift()();for(i=this.listeners,n=0,t=i.length;t>n;n++)(r=i[n])();return this.syncing=!1,this.cycles=0,!0},e.syncLater=function(e){return this.timeout?!1:(this.timeout=setTimeout(function(n){return function(){return n.timeout=null,n.sync(e)}}(this)),!0)},e.afterSync=function(e){if("function"!=typeof e)throw new TypeError("callback must be a function");return this.callbacks.push(e)},e.onSync=function(e){if("function"!=typeof e)throw new TypeError("listener must be a function");return this.listeners.push(e)},e.removeOnSync=function(e){var n;if("function"!=typeof e)throw new TypeError("listener must be a function");return n=this.listeners.indexOf(e),-1!==n?this.listeners.splice(n,1).pop():void 0},e}(),chip.Observer=Observer,Controller=function(){function e(){this._observers=[],this._children=[],this._syncListeners=[],this._closed=!1}return e.prototype.watch=function(e,n,t){var r,i,o,a,s;return Array.isArray(e)?("function"==typeof n&&(t=n,n=!1),s=t,r=!1,t=function(){var e;if(!r)return r=!0,setTimeout(function(){return r=!1}),e=a.map(function(e){return e.getter()}),s.apply(null,e)},a=e.map(function(e){return function(n){return e.watch(n,!0,t)}}(this)),n||t(),a):(i="function"==typeof e?e:expression.bind(e,this),o=Observer.add(i,n,t),o.expr=e,this._observers.push(o),o)},e.prototype.unwatch=function(e,n){return this._observers.some(function(t){return function(r,i){return r.expr===e&&r.callback===n?(r.close(),t._observers.splice(i,1),!0):!1}}(this))},e.prototype.eval=function(e,n){var t,r;return n&&(t={args:Object.keys(n)},r=t.args.map(function(e){return n[e]})),expression.get(e,t).apply(this,r)},e.prototype.evalSetter=function(e,n){return this.passthrough()!==this?this.passthrough().evalSetter(e,n):(e=e.replace(/(\s*\||$)/," = value$1"),expression.get(e,{args:["value"]}).call(this,n))},e.prototype.getBoundEval=function(){var e,n;return e=arguments[0],n=2<=arguments.length?slice1.call(arguments,1):[],expression.bind(e,this,{args:n})},e.prototype.redirect=function(e,n){return null==n&&(n=!1),this.app.redirect(e,n),this},e.prototype.cloneValue=function(e){return diff.clone(this[e])},e.prototype.closeController=function(){var e,n,t,r,i,o,a,s,u,c,l,p,f,h;if(!this._closed){for(this._closed=!0,l=this._children,t=0,i=l.length;i>t;t++)e=l[t],e._parent=null,e.closeController();if((null!=(p=this._parent)?p._children:void 0)&&(n=this._parent._children.indexOf(this),-1!==n&&this._parent._children.splice(n,1)),this._parent=null,this.hasOwnProperty("beforeClose")&&this.beforeClose(),this._syncListeners){for(f=this._syncListeners,r=0,o=f.length;o>r;r++)s=f[r],Observer.removeOnSync(s);delete this._syncListeners}for(h=this._observers,u=0,a=h.length;a>u;u++)c=h[u],c.close();this._observers.length=0,this.hasOwnProperty("onClose")&&this.onClose()}},e.prototype.sync=function(e){return Observer.sync(e),this},e.prototype.syncLater=function(e){return Observer.syncLater(e),this},e.prototype.syncThis=function(){return this._observers.forEach(function(e){return e.sync()}),this._children.forEach(function(e){return e.syncThis()}),this},e.prototype.afterSync=function(e){return Observer.afterSync(e),this},e.prototype.onSync=function(e){return this._syncListeners.push(e),Observer.onSync(e),this},e.prototype.removeOnSync=function(e){var n;return n=this._syncListeners.indexOf(e),-1!==n&&this._syncListeners.splice(n,1),Observer.removeOnSync(e),this},e.prototype.passthrough=function(e){return arguments.length?this._passthrough=e:this.hasOwnProperty("_passthrough")?this._passthrough:this},e}(),$.fn.controller=function(e){var n,t;for(t=this;t.length;){if(n=t.data("controller"))return e?n.passthrough():n;t=t.parent()}return null},$.widget||($.cleanData=function(e){return function(n){var t,r,i,o;for(i=0,o=n.length;o>i;i++){r=n[i];try{$(r).triggerHandler("remove")}catch(a){t=a}}return e(n)}}($.cleanData)),chip.Controller=Controller,expression={cache:{},globals:["true","false","window","this"]},expression.isInverted=function(e){return e.match(invertedExpr)&&!0},expression.revert=function(e){return e='"'+e.replace(invertedExpr,function(e,n){return'" + ('+n+') + "'})+'"',e.replace(/^"" \+ | \+ ""$/g,"")},expression.get=function(e,n){var t,r,i,o,a;if(null==n&&(n={}),t=n.args||[],i=e+"|"+t.join(","),a=expression.cache[i])return a;r=expression.parse(e,n);try{a=expression.cache[i]=Function.apply(null,slice1.call(t).concat([r]))}catch(s){throw o=s,console&&console.error("Bad expression:\n`"+e+"`\nCompiled expression:\n"+r),new Error(o.message)}return a},expression.bind=function(e,n,t){return expression.get(e,t).bind(n)},invertedExpr=/{{(.*)}}/g,quoteExpr=/(['"\/])(\\\1|[^\1])*?\1/g,emptyQuoteExpr=/(['"\/])\1/g,pipeExpr=/\|(\|)?/g,argSeparator=/\s*:\s*/g,propExpr=/((\{|,|\.)?\s*)([a-z$_\$](?:[a-z_\$0-9\.-]|\[['"\d]+\])*)(\s*(:|\(|\[)?)/gi,chainLinks=/\.|\[/g,chainLink=/\.|\[|\(/,setterExpr=/\s=\s/,ignore=null,strings=[],referenceCount=0,currentReference=0,currentIndex=0,finishedChain=!1,continuation=!1,expression.parse=function(e,n){return initParse(e,n),e=pullOutStrings(e),e=parseFilters(e),e=parseExpr(e),e="return "+e,e=putInStrings(e),e=addReferences(e)},initParse=function(e,n){return referenceCount=currentReference=0,ignore=expression.globals.concat((null!=n?n.globals:void 0)||[],(null!=n?n.args:void 0)||[]),strings.length=0},pullOutStrings=function(e){var n;return n=e.replace(quoteExpr,function(e,n){return strings.push(e),n+n})},putInStrings=function(e){return e=e.replace(emptyQuoteExpr,function(){return strings.shift()})},addReferences=function(e){var n,t,r,i;if(referenceCount){for(i=[],n=t=1,r=referenceCount;r>=1?r>=t:t>=r;n=r>=1?++t:--t)i.push("_ref"+n);e="var "+i.join(", ")+";\n"+e}return e},parseFilters=function(e){var n,t,r,i;return e=e.replace(pipeExpr,function(e,n){return n?e:"@@@"}),n=e.split(/\s*@@@\s*/),e=n.shift(),n.length?(setterExpr.test(e)?(t=e.split(setterExpr),r=t[0],i=t[1],r+=" = "):(r="",i=e),n.forEach(function(e){var n,t;return n=e.split(argSeparator),t=n.shift(),n.unshift(i),r&&n.push(!0),i="_filters."+t+".call(this, "+n.join(", ")+")"}),r+i):e},parseExpr=function(e){var n,t,r,i;return setterExpr.test(e)?(t=e.split(" = "),r=t[0],i=t[1],n="","!"===r.charAt(0)&&(n="!",r=r.slice(1)),r=parsePropertyChains(r).replace(/^\(|\)$/g,"")+" = ",i=parsePropertyChains(i),r+n+i):parsePropertyChains(e)},parsePropertyChains=function(e){var n,t,r;for(n="",r=[currentIndex,propExpr.lastIndex],currentIndex=0,propExpr.lastIndex=0;(t=nextChain(e))!==!1;)n+=t;return propExpr.lastIndex=r.pop(),currentIndex=r.pop(),n},nextChain=function(e){var n,t,r,i,o,a,s,u;return finishedChain?finishedChain=!1:(t=propExpr.exec(e))?(s=t,t=s[0],o=s[1],r=s[2],a=s[3],i=s[4],n=s[5],u=e.slice(currentIndex,propExpr.lastIndex-t.length),currentIndex=propExpr.lastIndex,r&&":"===n?u+t:u+parseChain(o,a,i,n,e)):(finishedChain=!0,e.slice(currentIndex))},splitLinks=function(e){var n,t,r;for(n=0,r=[];t=chainLinks.exec(e);)1!==chainLinks.lastIndex&&(r.push(e.slice(n,chainLinks.lastIndex-1)),n=chainLinks.lastIndex-1);return r.push(e.slice(n)),r},addThis=function(e){return-1===ignore.indexOf(e.split(chainLink).shift())?"this."+e:e},parseChain=function(e,n,t,r,i){var o,a,s;return continuation="."===e,continuation&&(n="."+n,e=""),a=splitLinks(n),s="",1!==a.length||continuation||r?(continuation||(s="("),a.forEach(function(e,n){n!==a.length-1?s+=parsePart(e,n):parens[r]?(t=t.replace(r,""),s+=parseFunction(e,n,i)):s+="_ref"+currentReference+e+")"})):(o=a[0],s=addThis(o)),e+s+t},parens={"(":")","[":"]"},parseFunction=function(e,n,t){var r,i,o;return r=getFunctionCall(t),e+=r.slice(0,1)+"~~insideParens~~"+r.slice(-1),i=r.slice(1,-1),"."===t.charAt(propExpr.lastIndex)?e=parsePart(e,n):0===n?(e=parsePart(e,n),e+="_ref"+currentReference+")"):e="_ref"+currentReference+e+")",o=currentReference,e=e.replace("~~insideParens~~",parsePropertyChains(i)),currentReference=o,e},getFunctionCall=function(e){var n,t,r,i,o;for(o=propExpr.lastIndex,r=e.charAt(o-1),n=parens[r],t=o-1,i=1;t++<e.length;){switch(e.charAt(t)){case r:i++;break;case n:i--}if(0===i)break}return currentIndex=propExpr.lastIndex=t+1,r+e.slice(o,t)+n},parsePart=function(e,n){var t;return e=0!==n||continuation?"_ref"+currentReference+e:-1===ignore.indexOf(e.split(/\.|\(|\[/).shift())?"this."+e:""+e,currentReference=++referenceCount,t="_ref"+currentReference,"("+t+" = "+e+") == null ? undefined : "},chip.expression=expression,Binding=function(){function e(e,n){this.name=e,this.expr=n}return e.bindings=[],e.addBinding=function(e,n,t){var r;return"function"==typeof n?(t=n,n={}):n||(n={}),r={name:n.name||e,priority:n.priority||0,keepAttribute:n.keepAttribute,handler:t},this.bindings[e]=r,this.bindings.push(r),this.bindings.sort(bindingSort),r},e.getBinding=function(e){return this.bindings.hasOwnProperty(e)?this.bindings[e]:void 0},e.removeBinding=function(e){var n;return(n=this.getBinding(e))?(delete this.bindings[e],this.bindings.splice(this.bindings.indexOf(n),1)):void 0},e.addEventBinding=function(e,n){var t;return t=e.split("-").slice(1).join("-"),this.addBinding(e,n,function(e,n,r){var i;return i=n.value,e.on(t,function(n){return n.preventDefault(),e.attr("disabled")?void 0:(r.thisElement=e,r.eval(i),delete r.thisElement)})})},e.addKeyEventBinding=function(e,n,t,r){return this.addBinding(e,r,function(e,r,i){var o;return o=r.value,e.on("keydown",function(r){return null!=t&&r.ctrlKey!==t&&r.metaKey!==t||r.keyCode!==n?void 0:(r.preventDefault(),e.attr("disabled")?void 0:(i.thisElement=e,i.eval(o),delete i.thisElement))})})},e.addAttributeBinding=function(e,n){var t;return t=e.split("-").slice(1).join("-"),this.addBinding(e,n,function(e,n,r){var i;return i=n.value,r.watch(i,function(n){return null!=n?(e.attr(t,n),e.trigger(t+"Changed")):e.removeAttr(t)})})},e.addAttributeToggleBinding=function(e,n){var t;return t=e.split("-").slice(1).join("-"),this.addBinding(e,n,function(e,n,r){var i;return i=n.value,r.watch(i,function(n){return e.prop(t,n&&!0||!1)})})},e.process=function(e,n){var t,r,i,o,a,s,u,c,l;if(!(n instanceof Controller))throw new Error("A Controller is required to bind a jQuery element.");for(c=Array.prototype.slice,l=new Walker(e.get(0)),s=[],l.onElementDone=function(e){return s.length&&s[s.length-1].get(0)===e?s.pop().triggerHandler("processed"):void 0};o=l.next();)for(o!==l.root&&(e=$(o)),a=o.parentNode,r=c.call(o.attributes).map(getBoundAttributes).filter(filterAttributes).sort(sortAttributes),r.length&&s.push(e);r.length;){if(t=r.shift(),i=t.binding,i.keepAttribute||e.removeAttr(t.name),"-*"===i.name.slice(-2)&&(t.match=t.name.replace(i.name.slice(0,-1),""),t.camel=t.match.replace(/[-_]+(\w)/g,function(e,n){return n.toUpperCase()})),u=i.handler(e,t,n),o.parentNode!==a){s.pop();break}if(u===!1){l.skip(),s.pop();break}}return e},e}(),getBoundAttributes=function(e){var n,t;if(n=Binding.getBinding(e.name),!n)for(t=e.name.split("-");t.length>1&&(t.pop(),!(n=Binding.getBinding(t.join("-")+"-*"))););return n||expression.isInverted(e.value)&&(n=Binding.getBinding("attr-*")),n?{binding:n,name:e.name,value:e.value}:void 0},filterAttributes=function(e){return e},sortAttributes=function(e,n){return n.binding.priority-e.binding.priority},bindingSort=function(e,n){return n.priority-e.priority},jQuery.fn.bindTo=function(e){return 0!==this.length?Binding.process(this,e):void 0},chip.Binding=Binding,Walker=function(){function e(e){this.root=e,this.current=null}return e.prototype.onElementDone=function(){},e.prototype.next=function(){return null===this.current?this.current=this.root:(this.current!==this.root&&null===this.current.parentNode&&(this.current=this.placeholder),this.current=this.traverse(this.current)),this.current?this.placeholder={parentNode:this.current.parentNode,nextElementSibling:this.current.nextElementSibling}:(this.placeholder=null,this.onElementDone(this.root)),this.current},e.prototype.traverse=function(e){var n,t;if(e.nodeType&&(n=e.firstElementChild))return n;for(;null!==e;){if(e.nodeType&&this.onElementDone(e),e===this.root)return null;if(t=e.nextElementSibling)return t;e=e.parentNode}return e},e.prototype.skip=function(){return this.current=this.placeholder},e}(),Filter=function(){function e(e,n){this.name=e,this.filter=n}return e.filters={},e.addFilter=function(e,n){return null!=n&&(this.filters[e]=n),this},e.getFilter=function(e){return this.filters[e]},e}(),chip.binding("bind-debug",{priority:200},function(e,n,t){var r;return r=n.value,t.watch(r,function(e){return"undefined"!=typeof console&&null!==console?console.info("Debug:",r,"=",e):void 0})}),chip.binding("bind-route",{keepAttribute:!0},function(){}),chip.binding("bind-text",function(e,n,t){var r;return r=n.value,t.watch(r,function(n){return e.text(null!=n?n:"")})}),chip.binding("bind-html",function(e,n,t){var r;return r=n.value,t.watch(r,function(n){return e.html(null!=n?n:"")})}),chip.binding("bind-trim",function(e,n,t){var r,i,o;for(i=e.get(0).firstChild,o=[];i;)r=i.nextSibling,i.nodeType===Node.TEXT_NODE&&(i.nodeValue.match(/^\s*$/)?i.parentNode.removeChild(i):i.textContent=i.textContent.trim()),o.push(i=r);return o}),chip.binding("bind-translate",function(e,n,t){var r,i,o,a,s,u,c,l;for(s=e.get(0).childNodes,l="",u=[],r=i=0,o=s.length;o>i;r=++i)a=s[r],3===a.nodeType?(""!==a.nodeValue.trim()||0!==r&&r!==s.length-1)&&(l+=a.nodeValue):1===a.nodeType&&(l+="%{"+u.length+"}",u.push(a));return c=function(){var n,r,i,o,a;for(a=t.translations[l]||l,n=/%{(\d+)}/g,s=[],r=0;i=n.exec(a);)o=n.lastIndex-i[0].length,r!==o&&s.push(document.createTextNode(a.slice(r,o))),s.push(u[i[1]]),r=n.lastIndex;return r!==a.length&&s.push(document.createTextNode(a.slice(r))),e.html(s)},e.on("remove",function(){return t.off("translationChange",c)}),t.on("translationChange",c),t.translations[l]?c():void 0}),chip.binding("bind-class",function(e,n,t){var r,i;return r=n.value,i=(e.attr("class")||"").split(/\s+/),""===i[0]&&i.pop(),t.watch(r,function(n){var t,r,o;if(Array.isArray(n)&&(n=n.join(" ")),"string"==typeof n)return e.attr("class",n.split(/\s+/).concat(i).join(" "));if(n&&"object"==typeof n){r=[];for(t in n)hasProp.call(n,t)&&(o=n[t],r.push(o?e.addClass(t):e.removeClass(t)));return r}})}),chip.binding("bind-attr",function(e,n,t){var r;return r=n.value,t.watch(r,function(n,t,r){var i,o,a;if(r)return r.forEach(function(t){return"deleted"===t.type||null==n[t.name]?(e.removeAttr(t.name),e.trigger(t.name+"Changed")):(e.attr(t.name,n[t.name]),e.trigger(t.name+"Changed"))});if(n&&"object"==typeof n){a=[];for(i in n)hasProp.call(n,i)&&(o=n[i],null!=o?(e.attr(i,o),a.push(e.trigger(i+"Changed"))):(e.removeAttr(i),a.push(e.trigger(i+"Changed"))));return a}})}),chip.binding("bind-active",function(e,n,t){var r,i,o;return r=n.value,r?t.watch(r,function(n){return n?e.addClass("active"):e.removeClass("active")}):(o=function(){return i.length&&i.get(0).href===location.href?e.addClass("active"):e.removeClass("active")},i=e.filter("a").add(e.find("a")).first(),i.on("hrefChanged",o),t.on("urlChange",o),e.on("remove",function(){return t.off("urlChange",o)}),o())}),chip.binding("bind-active-section",function(e,n,t){var r,i;return i=function(){return r.length&&0===location.href.indexOf(r.get(0).href)?e.addClass("active"):e.removeClass("active")},r=e.filter("a").add(e.find("a")).first(),r.on("hrefChanged",i),t.on("urlChange",i),e.on("remove",function(){return t.off("urlChange",i)}),i()}),chip.binding("bind-change-action",function(e,n,t){var r,i,o;return i=n.value,o=i.split(/\s*!\s*/),i=o[0],r=o[1],t.watch(i,function(n){return t.thisElement=e,t.eval(r),delete t.thisElement})}),chip.binding("bind-show",function(e,n,t){var r;return r=n.value,t.watch(r,function(n){return n?e.show():e.hide()})}),chip.binding("bind-hide",function(e,n,t){var r;return r=n.value,t.watch(r,function(n){return n?e.hide():e.show()})}),chip.binding("bind-value",function(e,n,t){var r,i,o,a,s,u,c,l,p,f,h,d;return a=n.value,d=a,s=e.attr("bind-value-field"),e.removeAttr("bind-value-field"),e.is("select")&&(l=s?t.eval(s):null,chip.lastSelectValueField=l),e.is("option")&&(s||chip.lastSelectValueField)&&(l=s?t.eval(s):chip.lastSelectValueField,d+="."+l),"checkbox"===e.attr("type")&&(r=e.attr("checked-value")||"true",f=e.attr("unchecked-value")||"false",e.removeAttr("checked-value"),e.removeAttr("unchecked-value"),i=t.eval(r),h=t.eval(f)),u="checkbox"===e.attr("type")?function(){return e.prop("checked")&&i||h}:"file"===e.attr("type")?function(){var n;return null!=(n=e.get(0).files)?n[0]:void 0}:e.is(":not(input,select,textarea,option)")?function(){return e.find("input:radio:checked").val()}:l&&e.is("select")?function(n){return n?$(e.get(0).options[e.get(0).selectedIndex]).data("value"):e.val()}:function(){return e.val()},p="checkbox"===e.attr("type")?function(n){return e.prop("checked",n===i)}:"file"===e.attr("type")?function(e){}:e.is(":not(input,select,textarea,option)")?function(n){return e.find("input:radio:checked").prop("checked",!1),e.find('input:radio[value="'+n+'"]').prop("checked",!0)}:function(n){var t;return t=l&&(null!=n?n[l]:void 0)||n,null!=t&&(t=""+t),e.val(t),l?e.data("value",n):void 0},c=t.watch(d,function(e){return u()!==""+e?p(t.eval(a)):void 0}),e.is("option")?void 0:(e.is("select")?e.one("processed",function(){return p(t.eval(a)),e.is("[readonly]")?void 0:t.evalSetter(a,u(!0))}):e.is("[readonly]")||t.evalSetter(a,u()),o=e.attr("bind-value-events")||"change",e.removeAttr("bind-value-events"),e.is(":text")&&e.on("keydown",function(n){return 13===n.keyCode?e.trigger("change"):void 0}),e.on(o,function(){return u()===c.oldValue||e.is("[readonly]")?void 0:(t.evalSetter(a,u(!0)),c.skipNextSync(),t.sync())}))}),chip.binding("on-*",function(e,n,t){var r,i;return r=n.match,i=n.value,e.on(r,function(n){return n.originalEvent&&n.preventDefault(),e.attr("disabled")?void 0:t.eval(i,{event:n,element:e})})}),chip.binding("native-*",function(e,n,t){var r,i;return r=n.match,i=n.value,e.on(r,function(n){return t.eval(i,{event:n,element:e})})}),keyCodes={enter:13,esc:27};for(name in keyCodes)hasProp.call(keyCodes,name)&&(keyCode=keyCodes[name],chip.keyEventBinding("on-"+name,keyCode));chip.keyEventBinding("on-ctrl-enter",keyCodes.enter,!0),chip.binding("attr-*",function(e,n,t){var r,i;return n.name!==n.match?(r=n.match,i=n.value):(r=n.name,i=expression.revert(n.value)),t.watch(i,function(n){return null!=n?(e.attr(r,n),e.trigger(r+"Changed")):e.removeAttr(r)})}),["attr-checked","attr-disabled","attr-multiple","attr-readonly","attr-selected"].forEach(function(e){return chip.attributeToggleBinding(e)}),$.fn.animateIn=function(e){var n;return this.parent().length&&(n=$("<!---->"),this.before(n),this.detach()),this.addClass("animate-in"),n&&(n.after(this),n.remove()),setTimeout(function(n){return function(){return n.removeClass("animate-in"),e?n.willAnimate()?n.one("webkittransitionend transitionend webkitanimationend animationend",function(){return e()}):e():void 0}}(this)),this},$.fn.animateOut=function(e,n){var t,r,i;return"function"==typeof e&&(n=e,e=!1),e||this.triggerHandler("remove"),r=this.cssDuration("transition")||this.cssDuration("animation"),r?(this.addClass("animate-out"),t=function(e){return function(){return clearTimeout(i),e.off("webkittransitionend transitionend webkitanimationend animationend",t),e.removeClass("animate-out"),n?n():e.remove()}}(this),this.one("webkittransitionend transitionend webkitanimationend animationend",t),i=setTimeout(t,r+100)):n?n():e||this.remove(),this},$.fn.cssDuration=function(e){var n,t;return t=this.css(e+"-duration")||this.css("-webkit-"+e+"-duration"),n=parseFloat(t),/\ds/.test(t)&&(n*=1e3),n||0},$.fn.willAnimate=function(){return this.cssDuration("transition")&&!0},chip.binding.prepareScope=prepareScope=function(e,n,t){var r,i,o,a;return a=$(e),o=$("<!--"+n.name+'="'+n.value+'"-->'),t.element[0]===e[0]?(i=document.createDocumentFragment(),i.appendChild(o[0]),e[0]=i):e.replaceWith(o),r=e.attr("bind-controller"),e.removeAttr("bind-controller"),{template:a,placeholder:o,controllerName:r}},chip.binding.swapPlaceholder=swapPlaceholder=function(e,n){return e[0].parentNode.replaceChild(n[0],e[0])},chip.binding("bind-if",{priority:50},function(e,n,t){var r,i,o,a,s;return i=n.value,a=prepareScope(e,n,t),s=a.template,o=a.placeholder,r=a.controllerName,t.watch(i,function(n){if(n){if(o[0].parentNode)return e=s.clone().animateIn(),t.child({element:e,name:r,passthrough:!0}),swapPlaceholder(o,e)}else if(!o[0].parentNode)return e.before(o),e.animateOut()}),!1}),chip.binding("bind-unless",{priority:50},function(e,n,t){var r,i,o,a,s;return i=n.value,a=prepareScope(e,n,t),s=a.template,o=a.placeholder,r=a.controllerName,t.watch(i,function(n){if(n){if(!o[0].parentNode)return e.before(o),e.animateOut()}else if(o[0].parentNode)return e=s.clone().animateIn(),t.child({element:e,name:r,passthrough:!0}),swapPlaceholder(o,e)}),!1}),chip.binding("bind-each",{priority:100},function(e,n,t){var r,i,o,a,s,u,c,l,p,f,h,d,v,g,y;if(c=a=n.value,h=prepareScope(e,n,t),g=h.template,l=h.placeholder,r=h.controllerName,d=a.split(/\s+in\s+/),s=d[0],a=d[1],v=s.split(/\s*,\s*/),s=v[0],p=v[1],!s||!a)throw'Invalid bind-each="'+c+'". Requires the format "item in list" or "key, propery in object".';return(u=a.match(/\[(.+?)(\.{2,3})(.+)\]/))&&(t.__each_range=".."===u[2]?function(e,n){var t,r,i,o,a;for(null==e&&(e=0),null==n&&(n=0),a=[],r=t=i=e,o=n;o>=i?o>=t:t>=o;r=o>=i?++t:--t)a.push(r);return a}:function(e,n){var t,r,i,o,a;for(null==e&&(e=0),null==n&&(n=0),a=[],r=t=i=e,o=n;o>=i?o>t:t>o;r=o>=i?++t:--t)a.push(r);return a},a="__each_range("+u[1]+", "+u[3]+")"),o=$(),f={},y=null,i=function(e,n){var i;return i=g.clone(),Array.isArray(y)?(f[s]=e,f.index=n):(p&&(f[p]=e),f[s]=y[e]),t.child({element:i,name:r,properties:f}),i.get(0)},t.watch(a,function(e,n,t){var r;if(y=e,t){if(Array.isArray(y)||y&&"object"==typeof y)return Array.isArray(y)||(t=diff.arrays(Object.keys(y),Object.keys(n))),r=0,t.forEach(function(e){return r+=e.addedCount}),t.forEach(function(e){var n,t,a,s,u;for(t=[e.index,e.removed.length],s=[],n=e.index;n<e.index+e.addedCount;)a=y[n],s.push(i(a,n)),n++;return u=$(o.splice.apply(o,t.concat(s))),u.length&&(o.length-s.length===0&&u.eq(0).before(l),r?u.remove():u.animateOut()),s.length?($(s).animateIn(),0===e.index?l.parent().length?l.after(s).remove():o.eq(s.length).before(s):o.eq(e.index-1).after(s)):void 0})}else if(o.length&&(o.eq(0).replaceWith(l),o.remove(),o=$()),e&&!Array.isArray(e)&&"object"==typeof e&&(e=Object.keys(e)),Array.isArray(y)&&y.length)return y.forEach(function(e,n){return o.push(i(e,n))}),l.after(o).remove()}),!1}),chip.binding("bind-partial",{priority:40},function(e,n,t){var r,i,o;return i=n.value,r=null,o={_partialContent:e.html()},e.is("iframe")&&e.css({border:"none",background:"none transparent",width:"100%"}),t.watch(i,function(n){var i,a,s,u;if(!e.is("iframe"))return e.animateOut(function(){return e.html(""),null!=n?(e.html(t.template(n)),e.animateIn(),r=t.child({element:e,name:n,properties:o})):void 0});if(null!=(a=e.data("body"))&&a.triggerHandler("remove"),null!=(s=e.data("body"))&&s.html(""),e.removeData("body"),n){u=function(i){return i.siblings("head").html($('link[rel="stylesheet"][href]').clone()).append("<style>\nbody {\n  background: none transparent;\n  width: auto;\n  min-width: 0;\n  margin: 0;\n  padding: 0;\n}\n</style>"),i.html(t.template(n)),r=t.child({element:i,name:n,properties:o}),e.height(i.outerHeight()),e.data("body",i)};try{return u(e.contents().find("body"))}catch(c){return i=c,e.one("load",function(){return u(e.contents().find("body"))}),e.attr("src","about:blank")}}}),!1}),chip.binding("local-*",{priority:20},function(e,n,t){var r,i;return r=n.value,i=n.camel,r?(t.watch(r,function(e){return t[i]=e}),")"!==r.slice(-1)&&t.watch(i,!0,function(e){return t.parent.passthrough().evalSetter(r,e)})):t[i]=!0,t.syncLater()}),chip.binding("bind-content",{priority:40},function(e,n,t){return t._partialContent?e.html(t._partialContent):void 0}),chip.binding("bind-controller",{priority:30},function(e,n,t){var r;return r=n.value,t.child({element:e,name:r}),!1}),chip.filter("filter",function(e,n){var t,r,i,o;if(!Array.isArray(e))return[];if(!n)return e;if("function"==typeof n)return e.filter(n,this);if(Array.isArray(n)){for(r=0,o=n.length;o>r;r++)t=n[r],e=e.filter(t,this);return e}if("object"==typeof n){for(i in n)hasProp.call(n,i)&&(t=n[i],"function"==typeof t&&(e=e.filter(t,this)));return e}}),chip.filter("map",function(e,n){return null!=e&&n?Array.isArray(e)?e.map(n,this):n.call(this,e):e}),chip.filter("reduce",function(e,n,t){return null!=e&&n?Array.isArray(e)?3===arguments.length?e.reduce(n,t):e.reduce(n):3===arguments.length?n(t,e):void 0:e}),chip.filter("slice",function(e,n,t){return Array.isArray(e)?e.slice(n,t):e}),chip.filter("date",function(e){return e?(e instanceof Date||(e=new Date(e)),isNaN(e.getTime())?"":e.toLocaleString()):""}),chip.filter("log",function(e,n){return null==n&&(n="Log"),console.log(n+":",e),e}),chip.filter("limit",function(e,n){return e&&"function"==typeof e.slice?0>n?e.slice(n):e.slice(0,n):e}),chip.filter("sort",function(e,n,t){var r,i,o,a;return n&&Array.isArray(e)?(t="desc"===t?-1:1,"string"==typeof n?(a=n.split(":"),o=a[0],r=a[1],r="desc"===r?-1:1,t=t||r,n=function(e,n){return e[o]>n[o]?t:e[o]<n[o]?-t:0}):-1===t&&(i=n,n=function(e,n){return-i(e,n)}),e.slice().sort(n)):e}),chip.filter("addQuery",function(e,n,t){var r,i,o,a,s;return s=e||location.href,a=s.split("?"),s=a[0],o=a[1],r="",null!=t&&(r=n+"="+encodeURIComponent(t)),o?(i=new RegExp("\\b"+n+"=[^&]*"),i.test(o)?o=o.replace(i,r):r&&(o+="&"+r)):o=r,o&&(s=[s,o].join("?")),s}),chip.filter("paginate",function(e,n,t,r){var i,o,a,s,u,c,l;return null==t&&(t=1),null==r&&(r="pagination"),n&&Array.isArray(e)?(u=Math.ceil(e.length/n),0>t?t=u+t+1:"function"==typeof t&&(t=t(e,n,u)||1),o=Math.min(u,Math.max(1,(null!=(l=this.query)?l.page:void 0)||t)),s=o-1,i=s*n,a=Math.min(i+n,e.length),this.app.rootController[r]||(this.app.rootController[r]={}),c=this.app.rootController[r],c.array=e,c.page=e.slice(i,a),c.pageSize=n,c.pageCount=u,c.defaultPage=t,c.currentPage=o,c.beginIndex=i,c.endIndex=a,this.trigger("paginated"),c.page):(delete this.app.rootController[r],this.trigger("paginated"),e)}),div=null,chip.filter("escape",function(e){return div||(div=$("<div></div>")),div.text(e||"").text()}),chip.filter("p",function(e){var n,t;return div||(div=$("<div></div>")),t=(e||"").split(/\r?\n/),n=t.map(function(e){return div.text(e).text()||"<br>"}),"<p>"+n.join("</p><p>")+"</p>"}),chip.filter("br",function(e){var n,t;return div||(div=$("<div></div>")),t=(e||"").split(/\r?\n/),n=t.map(function(e){return div.text(e).text()}),n.join("<br>")}),chip.filter("newline",function(e){var n,t;return div||(div=$("<div></div>")),t=(e||"").split(/\r?\n\s*\r?\n/),n=t.map(function(e){var t;return t=e.split(/\r?\n/),n=t.map(function(e){return div.text(e).text()}),n.join("<br>")}),"<p>"+n.join("</p><p>")+"</p>"}),urlExp=/(^|\s|\()((?:https?|ftp):\/\/[\-A-Z0-9+\u0026@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~(_|])/gi,chip.filter("autolink",function(e,n){return n=n?' target="_blank"':"",(""+e).replace(/<[^>]+>|[^<]+/g,function(e){return"<"===e.charAt(0)?e:e.replace(urlExp,'$1<a href="$2"'+n+">$2</a>")})}),chip.filter("int",function(e){return e=parseInt(e),isNaN(e)?null:e}),chip.filter("float",function(e){return e=parseFloat(e),isNaN(e)?null:e}),chip.filter("bool",function(e){return e&&"0"!==e&&"false"!==e}),diff={},function(){var e,n,t,r,i,o,a,s,u,c;return diff.clone=function(e,n){var t,r,i;if(Array.isArray(e))return n?e.map(function(e){return diff.clone(e,n)}):e.slice();if(e&&"object"==typeof e){if(e.valueOf()!==e)return new e.constructor(e.valueOf());t={};for(r in e)i=e[r],n&&(i=diff.clone(i,n)),t[r]=i;return t}return e},diff.values=function(e,n){var t,r,i,o;return Array.isArray(e)&&Array.isArray(n)?(i=diff.arrays(e,n),i.length?i:!1):e&&n&&"object"==typeof e&&"object"==typeof n?(o=e.valueOf(),r=n.valueOf(),"object"!=typeof o&&"object"!=typeof r?o!==r:(t=diff.objects(e,n),t.length?t:!1)):diff.basic(e,n)},diff.basic=function(e,n){var t,r;return e&&n&&"object"==typeof e&&"object"==typeof n&&(r=e.valueOf(),t=n.valueOf(),"object"!=typeof r&&"object"!=typeof t)?diff.basic(r,t):"number"==typeof e&&"number"==typeof n&&isNaN(e)&&isNaN(n)?!1:e!==n},diff.objects=function(e,n){var t,r,i,a;t=[];for(i in n)r=n[i],a=e[i],(void 0===a||diff.basic(a,r))&&(i in e?diff.basic(a,r)&&t.push(o(e,"updated",i,r)):t.push(o(e,"deleted",i,r)));for(i in e)a=e[i],i in n||t.push(o(e,"new",i));return Array.isArray(e)&&e.length!==n.length&&t.push(o(e,"updated","length",n.length)),t},o=function(e,n,t,r){return{object:e,type:n,name:t,oldValue:r}},t=0,r=1,e=2,n=3,diff.arrays=function(o,l){var p,f,h,d,v,g,y,b,m,x,C,k,A,w,E,_;if(f=0,p=o.length,x=0,b=l.length,y=Math.min(p,b),A=s(o,l,y),_=u(o,l,y-A),f+=A,x+=A,p-=_,b-=_,p-f===0&&b-x===0)return[];if(f===p)return[a(f,l.slice(x,b),0)];if(x===b)return[a(f,[],p-f)];for(h=i(o,f,p,l,x,b),k=c(h),w=void 0,E=[],d=f,m=x,v=0,g=k.length;g>v;v++)C=k[v],C===t?(w&&(E.push(w),w=void 0),d++,m++):C===r?(w||(w=a(d,[],0)),w.addedCount++,d++,w.removed.push(l[m]),m++):C===e?(w||(w=a(d,[],0)),w.addedCount++,d++):C===n&&(w||(w=a(d,[],0)),w.removed.push(l[m]),m++);return w&&E.push(w),E},s=function(e,n,t){var r,i,o;for(r=i=0,o=t;o>=0?o>i:i>o;r=o>=0?++i:--i)if(diff.basic(e[r],n[r]))return r;return t},u=function(e,n,t){var r,i,o;for(i=e.length,o=n.length,r=0;t>r&&!diff.basic(e[--i],n[--o]);)r++;return r},a=function(e,n,t){return{index:e,removed:n,addedCount:t}},c=function(i){var o,a,s,u,c,l,p,f;for(s=i.length-1,u=i[0].length-1,o=i[s][u],a=[];s>0||u>0;)0!==s?0!==u?(p=i[s-1][u-1],f=i[s-1][u],l=i[s][u-1],c=l>f?p>f?f:p:p>l?l:p,c===p?(p===o?a.push(t):(a.push(r),o=p),s--,u--):c===f?(a.push(n),s--,o=f):(a.push(e),u--,o=l)):(a.push(n),s--):(a.push(e),u--);return a.reverse(),a},i=function(e,n,t,r,i,o){var a,s,u,c,l,p,f,h,d,v,g,y,b,m,x;for(m=o-i+1,a=t-n+1,s=new Array(m),u=l=0,v=m;v>=0?v>l:l>v;u=v>=0?++l:--l)s[u]=new Array(a),s[u][0]=u;for(c=p=0,g=a;g>=0?g>p:p>g;c=g>=0?++p:--p)s[0][c]=c;for(u=f=1,y=m;y>=1?y>f:f>y;u=y>=1?++f:--f)for(c=h=1,b=a;b>=1?b>h:h>b;c=b>=1?++h:--h)diff.basic(e[n+c-1],r[i+u-1])?(d=s[u-1][c]+1,x=s[u][c-1]+1,s[u][c]=x>d?d:x):s[u][c]=s[u-1][c-1];return s}}.call(this),chip.diff=diff;