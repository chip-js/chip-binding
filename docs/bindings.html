<!DOCTYPE html>

<html>
<head>
  <title>Default Bindings</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="default-bindings">Default Bindings</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>

chip.binding <span class="hljs-string">'bind-debug'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">200</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-built_in">console</span>?.info <span class="hljs-string">'Debug:'</span>, expr, <span class="hljs-string">'='</span>, value</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="bind-route">bind-route</h2>
<p>Placeholder for routing and others</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-route'</span>, <span class="hljs-attribute">keepAttribute</span>: <span class="hljs-literal">true</span>, <span class="hljs-function">-&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="bind-text">bind-text</h2>
<p>Adds a handler to display text inside an element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"post.title"</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"info"</span>&gt;</span>
  Written by
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"post.author.name"</span>&gt;</span>author<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
  on
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"post.date.toLocaleDateString()"</span>&gt;</span>date<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>.
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Little Red<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"info"</span>&gt;</span>
  Written by
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Jacob Wright<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
  on
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>10/16/2013<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>.
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-text'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    element.text(<span class="hljs-keyword">if</span> value? <span class="hljs-keyword">then</span> value <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="bind-html">bind-html</h2>
<p>Adds a handler to display unescaped HTML inside an element. Be sure it’s trusted!</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"post.title"</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">bind-html</span>=<span class="hljs-value">"post.body"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Little Red<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Little Red Riding Hood is a story about a little girl.<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>
    More info can be found on
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"http://en.wikipedia.org/wiki/Little_Red_Riding_Hood"</span>&gt;</span>Wikipedia<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-html'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    element.html(<span class="hljs-keyword">if</span> value? <span class="hljs-keyword">then</span> value <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="bind-trim">bind-trim</h2>
<p>Adds a handler to trim whitespace text nodes inside an element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">bind-trim</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"info"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"post.author.name"</span>&gt;</span>author<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"post.date.toLocaleDateString()"</span>&gt;</span>date<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"info"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Jacob Wright<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>10/16/2013<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-trim'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  node = element.get(<span class="hljs-number">0</span>).firstChild
  <span class="hljs-keyword">while</span> node
    next = node.nextSibling
    <span class="hljs-keyword">if</span> node.nodeType <span class="hljs-keyword">is</span> Node.TEXT_NODE
      <span class="hljs-keyword">if</span> node.nodeValue.match <span class="hljs-regexp">/^\s*$/</span>
        node.parentNode.removeChild node
      <span class="hljs-keyword">else</span>
        node.textContent = node.textContent.trim()
    node = next</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2 id="bind-translate">bind-translate</h2>
<p>Adds a handler to translate the text inside an element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span> <span class="hljs-attribute">bind-translate</span>&gt;</span>Welcome <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"name"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>!<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p><em>Initial Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Welcome <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Jacob<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>!<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p><em>Result after changing the translations with</em></p>
<pre><code>app.translate({<span class="hljs-string">"Welcome %{0}!"</span>:<span class="hljs-string">"Sup %{0} Yo!"</span>})
</code></pre><pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Sup <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Jacob<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span> Yo!<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-translate'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  nodes = element.get(<span class="hljs-number">0</span>).childNodes
  text = <span class="hljs-string">''</span>
  placeholders = []
  <span class="hljs-keyword">for</span> node, i <span class="hljs-keyword">in</span> nodes
    <span class="hljs-keyword">if</span> node.nodeType <span class="hljs-keyword">is</span> <span class="hljs-number">3</span></pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Don’t include whitespace at the beginning and end of the translated string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">unless</span> node.nodeValue.trim() <span class="hljs-keyword">is</span> <span class="hljs-string">''</span> <span class="hljs-keyword">and</span> (i <span class="hljs-keyword">is</span> <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> i <span class="hljs-keyword">is</span> nodes.length - <span class="hljs-number">1</span>)
        text += node.nodeValue
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> node.nodeType <span class="hljs-keyword">is</span> <span class="hljs-number">1</span>
      text += <span class="hljs-string">'%{'</span> + placeholders.length + <span class="hljs-string">'}'</span>
      placeholders.push node
<span class="hljs-function">
  <span class="hljs-title">refresh</span> = -&gt;</span>
    translation = controller.translations[text] <span class="hljs-keyword">or</span> text
    exp = <span class="hljs-regexp">/%{(\d+)}/g</span>
    nodes = []
    lastIndex = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> (match = exp.exec translation)
      startIndex = exp.lastIndex - match[<span class="hljs-number">0</span>].length
      <span class="hljs-keyword">if</span> lastIndex <span class="hljs-keyword">isnt</span> startIndex
        nodes.push <span class="hljs-built_in">document</span>.createTextNode translation.slice lastIndex, startIndex
      nodes.push placeholders[match[<span class="hljs-number">1</span>]]
      lastIndex = exp.lastIndex

    <span class="hljs-keyword">if</span> lastIndex <span class="hljs-keyword">isnt</span> translation.length
      nodes.push <span class="hljs-built_in">document</span>.createTextNode translation.slice lastIndex

    element.html nodes

  element.<span class="hljs-literal">on</span> <span class="hljs-string">'remove'</span>, <span class="hljs-function">-&gt;</span> controller.<span class="hljs-literal">off</span> <span class="hljs-string">'translationChange'</span>, refresh
  controller.<span class="hljs-literal">on</span> <span class="hljs-string">'translationChange'</span>, refresh</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>don’t process if no translation is loaded</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> controller.translations[text]
    refresh()</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="bind-class">bind-class</h2>
<p>Adds a handler to add classes to an element. If the value of the expression is a string, that string will be set as the
class attribute. If the value is an array of strings, those will be set as the element classes. These two methods
overwrite any existing classes. If the value is an object, each property of that object will be toggled on or off in
the class list depending on whether the value of the property is truthy or falsey.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">bind-class</span>=<span class="hljs-value">"theClasses"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn primary"</span> <span class="hljs-attribute">bind-class</span>=<span class="hljs-value">"{highlight:ready}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p><em>Result if <code>theClases</code> equals “red blue” and <code>ready</code> is <code>true</code>:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"red blue"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn primary highlight"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-class'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  prevClasses = (element.attr(<span class="hljs-string">'class'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">''</span>).split(<span class="hljs-regexp">/\s+/</span>)
  prevClasses.pop() <span class="hljs-keyword">if</span> prevClasses[<span class="hljs-number">0</span>] <span class="hljs-keyword">is</span> <span class="hljs-string">''</span>

  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> Array.isArray(value)
      value = value.join(<span class="hljs-string">' '</span>)

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> value <span class="hljs-keyword">is</span> <span class="hljs-string">'string'</span>
      element.attr <span class="hljs-string">'class'</span>, value.split(<span class="hljs-regexp">/\s+/</span>).concat(prevClasses).join(<span class="hljs-string">' '</span>)
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> value <span class="hljs-keyword">and</span> <span class="hljs-keyword">typeof</span> value <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span>
      <span class="hljs-keyword">for</span> own className, toggle <span class="hljs-keyword">of</span> value
        <span class="hljs-keyword">if</span> toggle
          element.addClass(className)
        <span class="hljs-keyword">else</span>
          element.removeClass(className)


chip.binding <span class="hljs-string">'bind-attr'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value, oldValue, changes)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> changes</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>use the change records to remove deleted properties which won’t show up</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      changes.forEach (change) -&gt;
        <span class="hljs-keyword">if</span> change.type <span class="hljs-keyword">is</span> <span class="hljs-string">'deleted'</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> value[change.name]?
          element.removeAttr change.name
          element.trigger change.name + <span class="hljs-string">'Changed'</span>
        <span class="hljs-keyword">else</span>
          element.attr change.name, value[change.name]
          element.trigger change.name + <span class="hljs-string">'Changed'</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> value <span class="hljs-keyword">and</span> <span class="hljs-keyword">typeof</span> value <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span>
      <span class="hljs-keyword">for</span> own attrName, attrValue <span class="hljs-keyword">of</span> value
        <span class="hljs-keyword">if</span> attrValue?
          element.attr attrName, attrValue
          element.trigger attrName + <span class="hljs-string">'Changed'</span>
        <span class="hljs-keyword">else</span>
          element.removeAttr attrName
          element.trigger attrName + <span class="hljs-string">'Changed'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2 id="bind-active">bind-active</h2>
<p>Adds a handler to add the class “active” to an element if the expression is truthy, or if no expression is
provided it adds the “active” class if the element or it’s first anchor child’s href matches the URL in the browser.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary"</span> <span class="hljs-attribute">bind-active</span>=<span class="hljs-value">"formValid"</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"header-links"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-active</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/posts"</span>&gt;</span>My Blog<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-active</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/account"</span>&gt;</span>My Account<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-active</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/profile"</span>&gt;</span>Profile<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</code></pre>
<p><em>Result if <code>formValid</code> is <code>true</code> and the browser is at “<a href="http://www.example.com/account">http://www.example.com/account</a>“:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"btn btn-primary active"</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"header-links"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/posts"</span>&gt;</span>My Blog<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"active"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/account"</span>&gt;</span>My Account<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/profile"</span>&gt;</span>Profile<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-active'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  <span class="hljs-keyword">if</span> expr
    controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
      <span class="hljs-keyword">if</span> value
        element.addClass(<span class="hljs-string">'active'</span>)
      <span class="hljs-keyword">else</span>
        element.removeClass(<span class="hljs-string">'active'</span>)
  <span class="hljs-keyword">else</span>
<span class="hljs-function">    <span class="hljs-title">refresh</span> = -&gt;</span>
      <span class="hljs-keyword">if</span> link.length <span class="hljs-keyword">and</span> link.get(<span class="hljs-number">0</span>).href <span class="hljs-keyword">is</span> location.href
        element.addClass(<span class="hljs-string">'active'</span>)
      <span class="hljs-keyword">else</span>
        element.removeClass(<span class="hljs-string">'active'</span>)

    link = element
      .filter(<span class="hljs-string">'a'</span>)
      .add(element.find(<span class="hljs-string">'a'</span>))
      .first()
    link.<span class="hljs-literal">on</span> <span class="hljs-string">'hrefChanged'</span>, refresh
    controller.<span class="hljs-literal">on</span> <span class="hljs-string">'urlChange'</span>, refresh
    element.<span class="hljs-literal">on</span> <span class="hljs-string">'remove'</span>, <span class="hljs-function">-&gt;</span> controller.<span class="hljs-literal">off</span> <span class="hljs-string">'urlChange'</span>, refresh
    refresh()</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2 id="bind-active-section">bind-active-section</h2>
<p>The same as active except that the active class is added for any URL which starts with the link (marks active for the
whole section.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-active-section'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
<span class="hljs-function">  <span class="hljs-title">refresh</span> = -&gt;</span>
    <span class="hljs-keyword">if</span> link.length <span class="hljs-keyword">and</span> location.href.indexOf(link.get(<span class="hljs-number">0</span>).href) <span class="hljs-keyword">is</span> <span class="hljs-number">0</span>
      element.addClass(<span class="hljs-string">'active'</span>)
    <span class="hljs-keyword">else</span>
      element.removeClass(<span class="hljs-string">'active'</span>)

  link = element
    .filter(<span class="hljs-string">'a'</span>)
    .add(element.find(<span class="hljs-string">'a'</span>))
    .first()
  link.<span class="hljs-literal">on</span> <span class="hljs-string">'hrefChanged'</span>, refresh
  controller.<span class="hljs-literal">on</span> <span class="hljs-string">'urlChange'</span>, refresh
  element.<span class="hljs-literal">on</span> <span class="hljs-string">'remove'</span>, <span class="hljs-function">-&gt;</span> controller.<span class="hljs-literal">off</span> <span class="hljs-string">'urlChange'</span>, refresh
  refresh()</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h2 id="bind-change-action">bind-change-action</h2>
<p>Runs the action provided after the ! whenever the value before the ! changes.
This is for advanced use and a generic example doesn’t fit.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-change-action'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  [ expr, action ] = expr.split <span class="hljs-regexp">/\s*!\s*/</span>
  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    controller.thisElement = element
    controller.eval action
    <span class="hljs-keyword">delete</span> controller.thisElement


chip.binding <span class="hljs-string">'bind-show'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> value <span class="hljs-keyword">then</span> element.show() <span class="hljs-keyword">else</span> element.hide()


chip.binding <span class="hljs-string">'bind-hide'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> value <span class="hljs-keyword">then</span> element.hide() <span class="hljs-keyword">else</span> element.show()</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h2 id="bind-value">bind-value</h2>
<p>Adds a handler which sets the value of an HTML form element. This handler also updates the data as it is changed in
the form element, providing two way binding.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>First Name<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"firstName"</span> <span class="hljs-attribute">bind-value</span>=<span class="hljs-value">"user.firstName"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>Last Name<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"lastName"</span> <span class="hljs-attribute">bind-value</span>=<span class="hljs-value">"user.lastName"</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>First Name<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"firstName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"Jacob"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>Last Name<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"lastName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"Wright"</span>&gt;</span>
</code></pre>
<p>And when the user changes the text in the first input to “Jac”, <code>user.firstName</code> will be updated immediately with the
value of <code>&#39;Jac&#39;</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-value'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  watchExpr = expr

  fieldExpr = element.attr(<span class="hljs-string">'bind-value-field'</span>)
  element.removeAttr(<span class="hljs-string">'bind-value-field'</span>)

  <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'select'</span>)
    selectValueField = <span class="hljs-keyword">if</span> fieldExpr <span class="hljs-keyword">then</span> controller.eval(fieldExpr) <span class="hljs-keyword">else</span> <span class="hljs-literal">null</span>
    chip.lastSelectValueField = selectValueField

  <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'option'</span>) <span class="hljs-keyword">and</span> (fieldExpr <span class="hljs-keyword">or</span> chip.lastSelectValueField)
    <span class="hljs-keyword">if</span> fieldExpr
      selectValueField = controller.eval(fieldExpr)
    <span class="hljs-keyword">else</span>
      selectValueField = chip.lastSelectValueField
    watchExpr += <span class="hljs-string">'.'</span> + selectValueField

  <span class="hljs-keyword">if</span> element.attr(<span class="hljs-string">'type'</span>) <span class="hljs-keyword">is</span> <span class="hljs-string">'checkbox'</span>
    checkedAttr = element.attr(<span class="hljs-string">'checked-value'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">'true'</span>
    uncheckedAttr = element.attr(<span class="hljs-string">'unchecked-value'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">'false'</span>
    element.removeAttr(<span class="hljs-string">'checked-value'</span>)
    element.removeAttr(<span class="hljs-string">'unchecked-value'</span>)
    checkedValue = controller.eval(checkedAttr)
    uncheckedValue = controller.eval(uncheckedAttr)</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Handles input (checkboxes, radios), select, textarea, option</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  getValue =
    <span class="hljs-keyword">if</span> element.attr(<span class="hljs-string">'type'</span>) <span class="hljs-keyword">is</span> <span class="hljs-string">'checkbox'</span> <span class="hljs-comment"># Handles checkboxes</span>
      -&gt; element.prop(<span class="hljs-string">'checked'</span>) <span class="hljs-keyword">and</span> checkedValue <span class="hljs-keyword">or</span> uncheckedValue
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> element.attr(<span class="hljs-string">'type'</span>) <span class="hljs-keyword">is</span> <span class="hljs-string">'file'</span>
      -&gt; element.get(<span class="hljs-number">0</span>).files?[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">':not(input,select,textarea,option)'</span>) <span class="hljs-comment"># Handles a group of radio inputs</span>
      -&gt; element.find(<span class="hljs-string">'input:radio:checked'</span>).val()
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> selectValueField <span class="hljs-keyword">and</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'select'</span>)
      (realValue) -&gt;
        <span class="hljs-keyword">if</span> realValue
          $(element.get(<span class="hljs-number">0</span>).options[element.get(<span class="hljs-number">0</span>).selectedIndex]).data(<span class="hljs-string">'value'</span>)
        <span class="hljs-keyword">else</span>
          element.val()
    <span class="hljs-keyword">else</span> <span class="hljs-comment"># Handles other form inputs</span>
      -&gt; element.val()

  setValue =
    <span class="hljs-keyword">if</span> element.attr(<span class="hljs-string">'type'</span>) <span class="hljs-keyword">is</span> <span class="hljs-string">'checkbox'</span>
      (value) -&gt; element.prop(<span class="hljs-string">'checked'</span>, value <span class="hljs-keyword">is</span> checkedValue)
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> element.attr(<span class="hljs-string">'type'</span>) <span class="hljs-keyword">is</span> <span class="hljs-string">'file'</span>
      (value) -&gt; <span class="hljs-comment"># "get" only</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">':not(input,select,textarea,option)'</span>) <span class="hljs-comment"># Handles a group of radio inputs</span>
      (value) -&gt;
        element.find(<span class="hljs-string">'input:radio:checked'</span>).prop(<span class="hljs-string">'checked'</span>, <span class="hljs-literal">false</span>) <span class="hljs-comment"># in case the value isn't found in radios</span>
        element.find(<span class="hljs-string">'input:radio[value="'</span> + value + <span class="hljs-string">'"]'</span>).prop(<span class="hljs-string">'checked'</span>, <span class="hljs-literal">true</span>)
    <span class="hljs-keyword">else</span>
      (value) -&gt;
        strValue = selectValueField <span class="hljs-keyword">and</span> value?[selectValueField] <span class="hljs-keyword">or</span> value
        strValue = <span class="hljs-string">''</span> + strValue <span class="hljs-keyword">if</span> strValue?
        element.val(strValue)
        element.data(<span class="hljs-string">'value'</span>, value) <span class="hljs-keyword">if</span> selectValueField

  observer = controller.watch watchExpr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> getValue() <span class="hljs-keyword">isnt</span> <span class="hljs-string">''</span> + value <span class="hljs-comment"># Allows for string/number equality</span>
      setValue controller.eval expr</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Skips setting values on option elements since the user cannot change these with user input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span> <span class="hljs-string">'option'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Sets initial element value. For SELECT elements allows child option element values to be set first.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'select'</span>)
    element.one <span class="hljs-string">'processed'</span>, <span class="hljs-function">-&gt;</span>
      setValue controller.eval expr
      <span class="hljs-keyword">unless</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'[readonly]'</span>)
        controller.evalSetter expr, getValue(<span class="hljs-literal">true</span>)
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">unless</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'[readonly]'</span>)
    controller.evalSetter expr, getValue()

  events = element.attr(<span class="hljs-string">'bind-value-events'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">'change'</span>
  element.removeAttr(<span class="hljs-string">'bind-value-events'</span>)
  <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span> <span class="hljs-string">':text'</span>
    element.<span class="hljs-literal">on</span> <span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
      <span class="hljs-keyword">if</span> event.keyCode <span class="hljs-keyword">is</span> <span class="hljs-number">13</span>
        element.trigger <span class="hljs-string">'change'</span>

  element.<span class="hljs-literal">on</span> events, <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">if</span> getValue() <span class="hljs-keyword">isnt</span> observer.oldValue <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'[readonly]'</span>)
      controller.evalSetter expr, getValue(<span class="hljs-literal">true</span>)
      observer.skipNextSync() <span class="hljs-comment"># don't update this observer, user changed it</span>
      controller.sync() <span class="hljs-comment"># update other expressions looking at this data</span></pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h2 id="on-event-">on-[event]</h2>
<p>Adds a handler for each event name in the array. When the event is triggered the expression will be run.</p>
<p><strong>Example Events:</strong></p>
<ul>
<li>on-click</li>
<li>on-dblclick</li>
<li>on-submit</li>
<li>on-change</li>
<li>on-focus</li>
<li>on-blur</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">on-submit</span>=<span class="hljs-value">"saveUser()"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"firstName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"Jacob"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>
<p><em>Result (events don’t affect the HTML):</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">form</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"firstName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"Jacob"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'on-*'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  eventName = attr.match
  expr = attr.value
  element.<span class="hljs-literal">on</span> eventName, <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>prevent native events, let custom events use this mechanism</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> event.originalEvent
      event.preventDefault()
    <span class="hljs-keyword">unless</span> element.attr(<span class="hljs-string">'disabled'</span>)
      controller.eval expr, <span class="hljs-attribute">event</span>: event, <span class="hljs-attribute">element</span>: element</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <h2 id="native-event-">native-[event]</h2>
<p>Adds a handler for each event name in the array. When the event is triggered the expression will be run.
It will not call event.preventDefault() like on-* or withold when disabled.</p>
<p><strong>Example Events:</strong></p>
<ul>
<li>native-click</li>
<li>native-dblclick</li>
<li>native-submit</li>
<li>native-change</li>
<li>native-focus</li>
<li>native-blur</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">native-submit</span>=<span class="hljs-value">"saveUser(event)"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"firstName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"Jacob"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>
<p><em>Result (events don’t affect the HTML):</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">form</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"firstName"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"Jacob"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'native-*'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  eventName = attr.match
  expr = attr.value
  element.<span class="hljs-literal">on</span> eventName, <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    controller.eval expr, <span class="hljs-attribute">event</span>: event, <span class="hljs-attribute">element</span>: element</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <h2 id="on-key-event-">on-[key event]</h2>
<p>Adds a handler which is triggered when the keydown event’s <code>keyCode</code> property matches.</p>
<p><strong>Key Events:</strong></p>
<ul>
<li>on-enter</li>
<li>on-esc</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">on-enter</span>=<span class="hljs-value">"window.alert(element.val())"</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">input</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>keyCodes = { <span class="hljs-attribute">enter</span>: <span class="hljs-number">13</span>, <span class="hljs-attribute">esc</span>: <span class="hljs-number">27</span> }
<span class="hljs-keyword">for</span> own name, keyCode <span class="hljs-keyword">of</span> keyCodes
  chip.keyEventBinding(<span class="hljs-string">'on-'</span> + name, keyCode)</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <h2 id="on-control-key-event-">on-[control key event]</h2>
<p>Adds a handler which is triggered when the keydown event’s <code>keyCode</code> property matches and the ctrlKey or metaKey is
pressed.</p>
<p><strong>Key Events:</strong></p>
<ul>
<li>on-ctrl-enter</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">on-ctrl-enter</span>=<span class="hljs-value">"window.alert(element.val())"</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">input</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.keyEventBinding(<span class="hljs-string">'on-ctrl-enter'</span>, keyCodes.enter, <span class="hljs-literal">true</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <h2 id="attr-attribute-">attr-[attribute]</h2>
<p>Adds a handler to set the attribute of element to the value of the expression.</p>
<p><strong>Example Attributes:</strong></p>
<ul>
<li>attr-checked</li>
<li>attr-disabled</li>
<li>attr-multiple</li>
<li>attr-readonly</li>
<li>attr-selected</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">attr-src</span>=<span class="hljs-value">"user.avatarUrl"</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">img</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"http://cdn.example.com/avatars/jacwright-small.png"</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'attr-*'</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> attr.name <span class="hljs-keyword">isnt</span> attr.match <span class="hljs-comment"># e.g. attr-href="someUrl"</span>
    attrName = attr.match
    expr = attr.value
  <span class="hljs-keyword">else</span> <span class="hljs-comment"># e.g. href="http://example.com{{someUrl}}"</span>
    attrName = attr.name
    expr = expression.revert attr.value

  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> value?
      element.attr attrName, value
      element.trigger attrName + <span class="hljs-string">'Changed'</span>
    <span class="hljs-keyword">else</span>
      element.removeAttr attrName</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <h2 id="attr-toggle-attribute-">attr-[toggle attribute]</h2>
<p>Adds a handler to toggle an attribute on or off if the expression is truthy or falsey.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li>attr-checked</li>
<li>attr-disabled</li>
<li>attr-multiple</li>
<li>attr-readonly</li>
<li>attr-selected</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>Is Administrator<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"checkbox"</span> <span class="hljs-attribute">attr-checked</span>=<span class="hljs-value">"user.isAdmin"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">attr-disabled</span>=<span class="hljs-value">"isProcessing"</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
</code></pre>
<p><em>Result if <code>isProcessing</code> is <code>true</code> and <code>user.isAdmin</code> is false:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>Is Administrator<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"checkbox"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">disabled</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>[ <span class="hljs-string">'attr-checked'</span>, <span class="hljs-string">'attr-disabled'</span>, <span class="hljs-string">'attr-multiple'</span>, <span class="hljs-string">'attr-readonly'</span>, <span class="hljs-string">'attr-selected'</span> ].forEach (name) -&gt;
  chip.attributeToggleBinding(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <h2 id="animatein-animateout">animateIn/animateOut</h2>
<p>Adds a jquery plugin to allow an element to use CSS3 transitions or animations to animate in or out of the page. This
is used with bind-if, bind-each, etc. to show and hide elements.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.fn.animateIn = <span class="hljs-function"><span class="hljs-params">(callback)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> <span class="hljs-property">@parent</span>().length
    placeholder = $(<span class="hljs-string">'&lt;!----&gt;'</span>)
    <span class="hljs-property">@before</span>(placeholder)
    <span class="hljs-property">@detach</span>()

  <span class="hljs-property">@addClass</span> <span class="hljs-string">'animate-in'</span>

  <span class="hljs-keyword">if</span> placeholder
    placeholder.after(<span class="hljs-keyword">this</span>)
    placeholder.remove()

  setTimeout =&gt;
    <span class="hljs-property">@removeClass</span> <span class="hljs-string">'animate-in'</span>
    <span class="hljs-keyword">if</span> callback
      <span class="hljs-keyword">if</span> <span class="hljs-property">@willAnimate</span>()
        <span class="hljs-property">@one</span> <span class="hljs-string">'webkittransitionend transitionend webkitanimationend animationend'</span>, <span class="hljs-function">-&gt;</span> callback()
      <span class="hljs-keyword">else</span>
        callback()
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>

$.fn.animateOut = <span class="hljs-function"><span class="hljs-params">(dontRemove, callback)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> dontRemove <span class="hljs-keyword">is</span> <span class="hljs-string">'function'</span>
    callback = dontRemove
    dontRemove = <span class="hljs-literal">false</span>

  <span class="hljs-property">@triggerHandler</span> <span class="hljs-string">'remove'</span> <span class="hljs-keyword">unless</span> dontRemove
  duration = <span class="hljs-property">@cssDuration</span>(<span class="hljs-string">'transition'</span>) <span class="hljs-keyword">or</span> <span class="hljs-property">@cssDuration</span>(<span class="hljs-string">'animation'</span>)
  <span class="hljs-keyword">if</span> duration
    <span class="hljs-property">@addClass</span> <span class="hljs-string">'animate-out'</span>
<span class="hljs-function">    <span class="hljs-title">done</span> = =&gt;</span>
      clearTimeout timeout
      <span class="hljs-property">@off</span> <span class="hljs-string">'webkittransitionend transitionend webkitanimationend animationend'</span>, done
      <span class="hljs-property">@removeClass</span> <span class="hljs-string">'animate-out'</span>
      <span class="hljs-keyword">if</span> callback <span class="hljs-keyword">then</span> callback() <span class="hljs-keyword">else</span> <span class="hljs-property">@remove</span>()

    <span class="hljs-property">@one</span> <span class="hljs-string">'webkittransitionend transitionend webkitanimationend animationend'</span>, done</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>backup to ensure it “finishes”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    timeout = setTimeout done, duration + <span class="hljs-number">100</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">if</span> callback <span class="hljs-keyword">then</span> callback() <span class="hljs-keyword">else</span> <span class="hljs-keyword">unless</span> dontRemove <span class="hljs-keyword">then</span> <span class="hljs-property">@remove</span>()

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>

$.fn.cssDuration = <span class="hljs-function"><span class="hljs-params">(property)</span> -&gt;</span>
  time = <span class="hljs-property">@css</span>(property + <span class="hljs-string">'-duration'</span>) <span class="hljs-keyword">or</span> <span class="hljs-property">@css</span>(<span class="hljs-string">'-webkit-'</span> + property + <span class="hljs-string">'-duration'</span>)
  millis = parseFloat time
  millis *= <span class="hljs-number">1000</span> <span class="hljs-keyword">if</span> <span class="hljs-regexp">/\ds/</span>.test time
  millis <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>

$.fn.willAnimate = <span class="hljs-function">-&gt;</span>
  (<span class="hljs-property">@cssDuration</span> <span class="hljs-string">'transition'</span> <span class="hljs-keyword">or</span> <span class="hljs-property">@cssDuration</span> <span class="hljs-string">'animation'</span>) <span class="hljs-keyword">and</span> <span class="hljs-literal">true</span>


chip.binding.prepareScope = prepareScope = <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  template = $ element <span class="hljs-comment"># use a placeholder for the element and the element as a template</span>
  placeholder = $(<span class="hljs-string">"&lt;!--<span class="hljs-subst">#{attr.name}</span>=\"<span class="hljs-subst">#{attr.value}</span>\"--&gt;"</span>)
  <span class="hljs-keyword">if</span> controller.element[<span class="hljs-number">0</span>] <span class="hljs-keyword">is</span> element[<span class="hljs-number">0</span>]
    frag = <span class="hljs-built_in">document</span>.createDocumentFragment()
    frag.appendChild placeholder[<span class="hljs-number">0</span>]
    element[<span class="hljs-number">0</span>] = frag
  <span class="hljs-keyword">else</span>
    element.replaceWith placeholder
  controllerName = element.attr(<span class="hljs-string">'bind-controller'</span>)
  element.removeAttr(<span class="hljs-string">'bind-controller'</span>)
  <span class="hljs-attribute">template</span>: template, <span class="hljs-attribute">placeholder</span>: placeholder, <span class="hljs-attribute">controllerName</span>: controllerName

chip.binding.swapPlaceholder = swapPlaceholder = <span class="hljs-function"><span class="hljs-params">(placeholder, element)</span> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>A simple placeholder.replaceWith(element) but that works with fragments</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  placeholder[<span class="hljs-number">0</span>].parentNode.replaceChild element[<span class="hljs-number">0</span>], placeholder[<span class="hljs-number">0</span>]</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <h2 id="bind-if">bind-if</h2>
<p>Adds a handler to show or hide the element if the value is truthy or falsey. Actually removes the element from the DOM
when hidden, replacing it with a non-visible placeholder and not needlessly executing bindings inside.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"header-links"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-if</span>=<span class="hljs-value">"user"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/account"</span>&gt;</span>My Account<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-if</span>=<span class="hljs-value">"user"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/logout"</span>&gt;</span>Sign Out<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-if</span>=<span class="hljs-value">"!user"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/login"</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</code></pre>
<p><em>Result if <code>user</code> is null:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"header-links"</span>&gt;</span>
  <span class="hljs-comment">&lt;!--bind-if="user"--&gt;</span>
  <span class="hljs-comment">&lt;!--bind-if="user"--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/login"</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-if'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">50</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  { template, placeholder, controllerName } = prepareScope element, attr, controller

  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> value
      <span class="hljs-keyword">if</span> placeholder[<span class="hljs-number">0</span>].parentNode
        element = template.clone().animateIn()
        controller.child <span class="hljs-attribute">element</span>: element, <span class="hljs-attribute">name</span>: controllerName, <span class="hljs-attribute">passthrough</span>: <span class="hljs-literal">true</span>
        swapPlaceholder placeholder, element
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">unless</span> placeholder[<span class="hljs-number">0</span>].parentNode
        element.before placeholder
        element.animateOut()
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <h2 id="bind-unless">bind-unless</h2>
<p>Adds a handler to show or hide the element if the value is truthy or falsey. Actually removes the element from the DOM
when hidden, replacing it with a non-visible placeholder and not needlessly executing bindings inside.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"header-links"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-if</span>=<span class="hljs-value">"user"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/account"</span>&gt;</span>My Account<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-if</span>=<span class="hljs-value">"user"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/logout"</span>&gt;</span>Sign Out<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">bind-unless</span>=<span class="hljs-value">"user"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/login"</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</code></pre>
<p><em>Result if <code>user</code> is null:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"header-links"</span>&gt;</span>
  <span class="hljs-comment">&lt;!--bind-if="user"--&gt;</span>
  <span class="hljs-comment">&lt;!--bind-if="user"--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/login"</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-unless'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">50</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  { template, placeholder, controllerName } = prepareScope element, attr, controller

  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
    <span class="hljs-keyword">unless</span> value
      <span class="hljs-keyword">if</span> placeholder[<span class="hljs-number">0</span>].parentNode
        element = template.clone().animateIn()
        controller.child <span class="hljs-attribute">element</span>: element, <span class="hljs-attribute">name</span>: controllerName, <span class="hljs-attribute">passthrough</span>: <span class="hljs-literal">true</span>
        swapPlaceholder placeholder, element
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">unless</span> placeholder[<span class="hljs-number">0</span>].parentNode
        element.before placeholder
        element.animateOut()
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <h2 id="bind-each">bind-each</h2>
<p>Adds a handler to duplicate an element for each item in an array. Creates a new controller for each item, optionally
running the controller definition if <code>bind-controller</code> is set on the element after <code>bind-each</code>. The expression must
be of the format <code>itemName in arrayName</code> where <code>itemName</code> is the name each item inside the array will be referenced
by inside the element. <code>arrayName</code> is any expression, e.g. <code>post in user.getPosts()</code>.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">bind-each</span>=<span class="hljs-value">"post in posts"</span> <span class="hljs-attribute">bind-class</span>=<span class="hljs-value">"{featured:post.isFeatured}"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h1</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"post.title"</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">bind-html</span>=<span class="hljs-value">"post.body"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p><em>Result if there are 2 posts and the first one is featured:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"featured"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Little Red<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Little Red Riding Hood is a story about a little girl.<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>
      More info can be found on
      <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"http://en.wikipedia.org/wiki/Little_Red_Riding_Hood"</span>&gt;</span>Wikipedia<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Big Blue<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Some thoughts on the New York Giants.<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>
      More info can be found on
      <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"http://en.wikipedia.org/wiki/New_York_Giants"</span>&gt;</span>Wikipedia<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-each'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">100</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  orig = expr = attr.value
  { template, placeholder, controllerName } = prepareScope element, attr, controller
  [ itemName, expr ] = expr.split <span class="hljs-regexp">/\s+in\s+/</span>
  [ itemName, propName ] = itemName.split <span class="hljs-regexp">/\s*,\s*/</span>
  <span class="hljs-keyword">unless</span> itemName <span class="hljs-keyword">and</span> expr
    <span class="hljs-keyword">throw</span> <span class="hljs-string">"Invalid bind-each=\""</span> +
      orig +
      <span class="hljs-string">'". Requires the format "item in list"'</span> +
      <span class="hljs-string">' or "key, propery in object".'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Allow bind-each=”i in [0…10]” or bind-each=”pageNum in [1..pageCount]”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (match = expr.match <span class="hljs-regexp">/\[(.+?)(\.{2,3})(.+)\]/</span>)
    <span class="hljs-keyword">if</span> match[<span class="hljs-number">2</span>] <span class="hljs-keyword">is</span> <span class="hljs-string">'..'</span>
      controller.__each_range = <span class="hljs-function"><span class="hljs-params">(start = <span class="hljs-number">0</span>, end = <span class="hljs-number">0</span>)</span> -&gt;</span>
        num <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> [start..end]
    <span class="hljs-keyword">else</span>
      controller.__each_range = <span class="hljs-function"><span class="hljs-params">(start = <span class="hljs-number">0</span>, end = <span class="hljs-number">0</span>)</span> -&gt;</span>
        num <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> [start...end]
    expr = <span class="hljs-string">"__each_range(<span class="hljs-subst">#{match[<span class="hljs-number">1</span>]}</span>, <span class="hljs-subst">#{match[<span class="hljs-number">3</span>]}</span>)"</span>

  elements = $()
  properties = {}
  value = <span class="hljs-literal">null</span>
<span class="hljs-function">
  <span class="hljs-title">createElement</span> = <span class="hljs-params">(item, index)</span> -&gt;</span>
    newElement = template.clone()
    <span class="hljs-keyword">unless</span> Array.isArray(value)
      properties[propName] = item <span class="hljs-keyword">if</span> propName
      properties[itemName] = value[item]
    <span class="hljs-keyword">else</span>
      properties[itemName] = item
      properties.index = index
    controller.child <span class="hljs-attribute">element</span>: newElement, <span class="hljs-attribute">name</span>: controllerName, <span class="hljs-attribute">properties</span>: properties
    newElement.get(<span class="hljs-number">0</span>)

  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(newValue, oldValue, splices)</span> -&gt;</span>
    value = newValue

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> splices <span class="hljs-comment"># first time setup (or changing from/to an array value)</span>
      <span class="hljs-keyword">if</span> elements.length
        elements.eq(<span class="hljs-number">0</span>).replaceWith(placeholder)
        elements.remove()
        elements = $()

      <span class="hljs-keyword">if</span> newValue <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> Array.isArray(newValue) <span class="hljs-keyword">and</span> <span class="hljs-keyword">typeof</span> newValue <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span>
        newValue = Object.keys newValue

      <span class="hljs-keyword">if</span> Array.isArray(value) <span class="hljs-keyword">and</span> value.length
        value.forEach (item, index) -&gt;
          elements.push createElement item, index
        placeholder.after(elements).remove()

    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> Array.isArray(value) <span class="hljs-keyword">or</span> (value <span class="hljs-keyword">and</span> <span class="hljs-keyword">typeof</span> value <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span>)
      <span class="hljs-keyword">unless</span> Array.isArray(value)
        splices = diff.arrays Object.keys(value), Object.keys(oldValue)

      hasNew = <span class="hljs-number">0</span>
      splices.forEach (splice) -&gt; hasNew += splice.addedCount

      splices.forEach (splice) -&gt;
        args = [splice.index, splice.removed.length]

        newElements = []
        addIndex = splice.index
        <span class="hljs-keyword">while</span> (addIndex &lt; splice.index + splice.addedCount)
          item = value[addIndex]
          newElements.push createElement item, addIndex
          addIndex++

        removedElements = $ elements.splice.apply(elements, args.concat(newElements))

        <span class="hljs-keyword">if</span> removedElements.length
          <span class="hljs-keyword">if</span> elements.length - newElements.length <span class="hljs-keyword">is</span> <span class="hljs-number">0</span> <span class="hljs-comment"># removing all existing elements</span>
            removedElements.eq(<span class="hljs-number">0</span>).before(placeholder)
          <span class="hljs-keyword">if</span> hasNew
            removedElements.remove()
          <span class="hljs-keyword">else</span>
            removedElements.animateOut()

        <span class="hljs-keyword">if</span> newElements.length
          $(newElements).animateIn()
          <span class="hljs-keyword">if</span> splice.index <span class="hljs-keyword">is</span> <span class="hljs-number">0</span>
            <span class="hljs-keyword">if</span> placeholder.parent().length
              placeholder.after(newElements).remove()
            <span class="hljs-keyword">else</span>
              elements.eq(newElements.length).before(newElements)
          <span class="hljs-keyword">else</span>
            elements.eq(splice.index - <span class="hljs-number">1</span>).after(newElements)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <h2 id="bind-partial">bind-partial</h2>
<p>Adds a handler to set the contents of the element with the template and controller by that name. The expression may
be just the name of the template/controller, or it may be of the format <code>partialName</code>. Use the local-* binding
to pass data into a partial.</p>

            </div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-comment">&lt;!--&lt;div bind-partial="userInfo"&gt;&lt;/div&gt;--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">bind-partial</span>=<span class="hljs-value">"userInfo"</span> <span class="hljs-attribute">local-user</span>=<span class="hljs-value">"getUser()"</span> <span class="hljs-attribute">bind-class</span>=<span class="hljs-value">"{administrator:user.isAdmin}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"userInfo"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/html"</span>&gt;</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">bind-text</span>=<span class="hljs-value">"user.name"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="hljs-comment">&lt;!--&lt;div bind-partial="userInfo"&gt;&lt;/div&gt;--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"administrator"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Jacob<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-partial'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">40</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  childController = <span class="hljs-literal">null</span>
  properties = <span class="hljs-attribute">_partialContent</span>: element.html()

  <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'iframe'</span>)
      element.css
        <span class="hljs-attribute">border</span>: <span class="hljs-string">'none'</span>
        <span class="hljs-attribute">background</span>: <span class="hljs-string">'none transparent'</span>
        <span class="hljs-attribute">width</span>: <span class="hljs-string">'100%'</span>

  controller.watch expr, <span class="hljs-function"><span class="hljs-params">(name)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> element.<span class="hljs-keyword">is</span>(<span class="hljs-string">'iframe'</span>)
      element.data(<span class="hljs-string">'body'</span>)?.triggerHandler(<span class="hljs-string">'remove'</span>)
      element.data(<span class="hljs-string">'body'</span>)?.html(<span class="hljs-string">''</span>)
      element.removeData(<span class="hljs-string">'body'</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> name
<span class="hljs-function">
      <span class="hljs-title">setup</span> = <span class="hljs-params">(body)</span> -&gt;</span>
        body.siblings(<span class="hljs-string">'head'</span>)
          .html($(<span class="hljs-string">'link[rel="stylesheet"][href]'</span>).clone())
          .append <span class="hljs-string">'''&lt;style&gt;
body {
  background: none transparent;
  width: auto;
  min-width: 0;
  margin: 0;
  padding: 0;
}
&lt;/style&gt;'''</span>
        body.html controller.template(name)
        childController = controller.child <span class="hljs-attribute">element</span>: body, <span class="hljs-attribute">name</span>: name, <span class="hljs-attribute">properties</span>: properties
        element.height body.outerHeight()
        element.data(<span class="hljs-string">'body'</span>, body)

      <span class="hljs-keyword">try</span>
        setup element.contents().find(<span class="hljs-string">'body'</span>)
      <span class="hljs-keyword">catch</span> e <span class="hljs-comment"># cross domain issues</span>
        element.one <span class="hljs-string">'load'</span>, <span class="hljs-function">-&gt;</span> setup element.contents().find(<span class="hljs-string">'body'</span>)
        element.attr <span class="hljs-string">'src'</span>, <span class="hljs-string">'about:blank'</span>
    <span class="hljs-keyword">else</span>
      element.animateOut -&gt;
        element.html(<span class="hljs-string">''</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> name?
        element.html controller.template(name)
        element.animateIn()
        childController = controller.child <span class="hljs-attribute">element</span>: element, <span class="hljs-attribute">name</span>: name, <span class="hljs-attribute">properties</span>: properties
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <h2 id="local-">local-*</h2>
<p>You may pass data into bind-partial, bind-each, bind-if, or bind-controller using this wildcard
binding by using attributes prefixed with <code>local-</code>. The attribute name portion that follows <code>local-</code>
will be converted to camelCase and the value will be set locally. Examples:
<code>local-link=&quot;user.addressUrl&quot;</code> will pass the value of <code>user.addressUrl</code> into the partial as <code>link</code>.
<code>local-post-body=&quot;user.description&quot;</code> will pass the value of <code>user.description</code> into the partial as <code>postBody</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'local-*'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">20</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  expr = attr.value
  prop = attr.camel
  <span class="hljs-keyword">if</span> expr
    controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
      controller[prop] = value</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>make a two-way binding if it doesn’t end in a method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> expr.slice(-<span class="hljs-number">1</span>) <span class="hljs-keyword">isnt</span> <span class="hljs-string">')'</span>
      controller.watch prop, <span class="hljs-literal">true</span>, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Set on the parent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        controller.parent.passthrough().evalSetter expr, value
  <span class="hljs-keyword">else</span>
    controller[prop] = <span class="hljs-literal">true</span>
  controller.syncLater() <span class="hljs-comment">#run sync so the partial can get these values</span></pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <h2 id="bind-content">bind-content</h2>
<p>Allows an element with a <code>bind-partial</code> attribute to include HTML within it that may be inserted somewhere
inside the partial’s template.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-content'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">40</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Allow a default if content wasn’t provided by the partial</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> controller._partialContent
    element.html controller._partialContent</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <h2 id="bind-controller">bind-controller</h2>
<p>Adds a handler to create a new controller for this element and its descendants. The value of the attribute is the
controller definition name which will be run if provided. Use this when you want to sandbox controller values (such
as a form) or provide functionality provided by that controller to the element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">bind-controller</span>=<span class="hljs-value">"userForm"</span> <span class="hljs-attribute">bind-submit</span>=<span class="hljs-value">"saveUser()"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>
<p><em>Result if <code>formValid</code> is <code>true</code> and the browser is at “<a href="http://www.example.com/account">http://www.example.com/account</a>“:</em></p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="hljs-string">'bind-controller'</span>, <span class="hljs-attribute">priority</span>: <span class="hljs-number">30</span>, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
  controllerName = attr.value
  controller.child <span class="hljs-attribute">element</span>: element, <span class="hljs-attribute">name</span>: controllerName
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
