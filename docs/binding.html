<!DOCTYPE html>

<html>
<head>
  <title>Chip Binding</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="chip-binding">Chip Binding</h1>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>A Binding instance is created for each binding attribute in the DOM. Mostly the Binding class is used as a static
place to register new bind handlers.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Binding</span></span>
  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@name</span>, <span class="hljs-property">@expr</span>)</span> -&gt;</span>

  <span class="hljs-property">@bindings</span>: []</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Adds a binding handler that will be run for each attribute whose name matches <code>@prefix + name</code>. The <code>handler</code> is
a function that receives three arguments: the jQuery element the attribute was on, the value of the attribute
(usually an expression), and the controller for this area of the page.</p>
<p>If the handler removes the element from its parent (to store as a template for cloning into repeats or ifs) then
processing will stop on the element and its children immediately. This allows you to recurse into the element
with new controllers by using <code>element.bindTo(newChildController)</code>.</p>
<p>If a new controller is returned from the handler this controller will be used for the remaining handlers and the
children of the element.</p>
<p>The <code>priority</code> argument is optional and allows handlers with higher priority to be run before those with lower
priority. The default is <code>0</code>.</p>
<p><strong>Example:</strong> This binding handler adds pirateized text to an element.</p>
<pre><code class="lang-javascript">Binding.addBinding(<span class="hljs-string">'my-pirate'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(element, expr, controller)</span> </span>{
  controller.watch(expr, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value)</span> </span>{
    value = (value+<span class="hljs-string">''</span> || <span class="hljs-string">''</span>)
      .replace(<span class="hljs-regexp">/\Bing\b/g</span>, <span class="hljs-string">"in'"</span>)
      .replace(<span class="hljs-regexp">/\bto\b/g</span>, <span class="hljs-string">"t'"</span>)
      .replace(<span class="hljs-regexp">/\byou\b/</span>, <span class="hljs-string">'ye'</span>)
      + <span class="hljs-string">' arrrr!'</span>
    element.text(value)
  }
})
</code></pre>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">my-pirate</span>=<span class="hljs-value">"post.body"</span>&gt;</span>This text will be replaced.<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@addBinding</span>: <span class="hljs-function"><span class="hljs-params">(name, options, handler)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> options <span class="hljs-keyword">is</span> <span class="hljs-string">'function'</span>
      handler = options
      options = {}
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">unless</span> options
      options = {}

    entry =
      <span class="hljs-attribute">name</span>: options.name <span class="hljs-keyword">or</span> name
      <span class="hljs-attribute">priority</span>: options.priority <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>
      <span class="hljs-attribute">keepAttribute</span>: options.keepAttribute
      <span class="hljs-attribute">handler</span>: handler
    <span class="hljs-property">@bindings</span>[name] = entry
    <span class="hljs-property">@bindings</span>.push entry

    <span class="hljs-property">@bindings</span>.sort bindingSort
    entry</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Returns a binding object that was added with <code>addBinding()</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@getBinding</span>: <span class="hljs-function"><span class="hljs-params">(name)</span> -&gt;</span>
    <span class="hljs-property">@bindings</span>[name] <span class="hljs-keyword">if</span> <span class="hljs-property">@bindings</span>.hasOwnProperty(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Removes a binding handler that was added with <code>addBinding()</code>.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-javascript">Binding.removeBinding(<span class="hljs-string">'pirate'</span>)
</code></pre>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">my-pirate</span>=<span class="hljs-value">"post.body"</span>&gt;</span>This text will not be replaced.<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@removeBinding</span>: <span class="hljs-function"><span class="hljs-params">(name)</span> -&gt;</span>
    entry = <span class="hljs-property">@getBinding</span>(name)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> entry
    <span class="hljs-keyword">delete</span> <span class="hljs-property">@bindings</span>[name]
    <span class="hljs-property">@bindings</span>.splice <span class="hljs-property">@bindings</span>.indexOf(entry), <span class="hljs-number">1</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Shortcut, adds a handler that executes the expression when the named event is dispatched.</p>
<p><strong>Example:</strong> Handles the click event.</p>
<pre><code class="lang-javascript">Binding.addEventBinding(<span class="hljs-string">'on-click'</span>)
</code></pre>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">on-click</span>=<span class="hljs-value">"window.alert('hello!')"</span>&gt;</span>Say Hello<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@addEventBinding</span>: <span class="hljs-function"><span class="hljs-params">(name, options)</span> -&gt;</span>
    eventName = name.split(<span class="hljs-string">'-'</span>).slice(<span class="hljs-number">1</span>).join(<span class="hljs-string">'-'</span>)
    <span class="hljs-property">@addBinding</span> name, options, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
      expr = attr.value
      element.<span class="hljs-literal">on</span> eventName, <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
        event.preventDefault()
        <span class="hljs-keyword">unless</span> element.attr(<span class="hljs-string">'disabled'</span>)
          controller.thisElement = element
          controller.eval expr
          <span class="hljs-keyword">delete</span> controller.thisElement</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Shortcut, adds a handler that responds when the given key is pressed, e.g. <code>Binding.addEventBinding(&#39;on-esc&#39;, 27)</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@addKeyEventBinding</span>: <span class="hljs-function"><span class="hljs-params">(name, keyCode, ctrlKey, options)</span> -&gt;</span>
    <span class="hljs-property">@addBinding</span> name, options, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
      expr = attr.value
      element.<span class="hljs-literal">on</span> <span class="hljs-string">'keydown'</span>, <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> ctrlKey? <span class="hljs-keyword">and</span> (event.ctrlKey <span class="hljs-keyword">isnt</span> ctrlKey <span class="hljs-keyword">and</span> event.metaKey <span class="hljs-keyword">isnt</span> ctrlKey)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> event.keyCode <span class="hljs-keyword">is</span> keyCode
        event.preventDefault()
        <span class="hljs-keyword">unless</span> element.attr(<span class="hljs-string">'disabled'</span>)
          controller.thisElement = element
          controller.eval expr
          <span class="hljs-keyword">delete</span> controller.thisElement</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Shortcut, adds a handler to set the named attribute to the value of the expression.</p>
<p><strong>Example</strong></p>
<pre><code class="lang-javascript">Binding.addAttributeBinding(<span class="hljs-string">'attr-href'</span>)
</code></pre>
<p>allows</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">attr-href</span>=<span class="hljs-value">"'/profile/' + person.id"</span>&gt;</span>My Profile<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
</code></pre>
<p>which would result in</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"/profile/368"</span>&gt;</span>My Profile<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@addAttributeBinding</span>: <span class="hljs-function"><span class="hljs-params">(name, options)</span> -&gt;</span>
    attrName = name.split(<span class="hljs-string">'-'</span>).slice(<span class="hljs-number">1</span>).join(<span class="hljs-string">'-'</span>)
    <span class="hljs-property">@addBinding</span> name, options, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
      expr = attr.value
      controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
        <span class="hljs-keyword">if</span> value?
          element.attr attrName, value
          element.trigger attrName + <span class="hljs-string">'Changed'</span>
        <span class="hljs-keyword">else</span>
          element.removeAttr attrName</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Shortcut, adds a handler to toggle an attribute on or off if the value of the expression is truthy or false,
e.g. <code>Binding.addAttributeToggleBinding(&#39;attr-checked&#39;)</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@addAttributeToggleBinding</span>: <span class="hljs-function"><span class="hljs-params">(name, options)</span> -&gt;</span>
    attrName = name.split(<span class="hljs-string">'-'</span>).slice(<span class="hljs-number">1</span>).join(<span class="hljs-string">'-'</span>)
    <span class="hljs-property">@addBinding</span> name, options, <span class="hljs-function"><span class="hljs-params">(element, attr, controller)</span> -&gt;</span>
      expr = attr.value
      controller.watch expr, <span class="hljs-function"><span class="hljs-params">(value)</span> -&gt;</span>
        element.prop attrName, value <span class="hljs-keyword">and</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">or</span> <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Processes the bindings for the given jQuery element and all of its children.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-property">@process</span>: <span class="hljs-function"><span class="hljs-params">(element, controller)</span> -&gt;</span>
    <span class="hljs-keyword">unless</span> controller <span class="hljs-keyword">instanceof</span> Controller
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error <span class="hljs-string">'A Controller is required to bind a jQuery element.'</span>


    slice = <span class="hljs-attribute">Array</span>::slice
    walker = <span class="hljs-keyword">new</span> Walker element.get(<span class="hljs-number">0</span>)
    processed = []
    walker.onElementDone = <span class="hljs-function"><span class="hljs-params">(node)</span> -&gt;</span>
      <span class="hljs-keyword">if</span> processed.length <span class="hljs-keyword">and</span> processed[processed.length - <span class="hljs-number">1</span>].get(<span class="hljs-number">0</span>) <span class="hljs-keyword">is</span> node
        processed.pop().triggerHandler(<span class="hljs-string">'processed'</span>)

    <span class="hljs-keyword">while</span> node = walker.next()
      element = $ node <span class="hljs-keyword">if</span> node <span class="hljs-keyword">isnt</span> walker.root
      parentNode = node.parentNode</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Finds binding attributes and sorts by priority.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      attributes = slice.call(node.attributes)
        .map(getBoundAttributes)
        .filter(filterAttributes)
        .sort(sortAttributes)

      processed.push element <span class="hljs-keyword">if</span> attributes.length</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Go through each binding attribute from first to last.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">while</span> attributes.length
        attribute = attributes.shift()
        binding = attribute.binding</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Remove the binding handlers so they only get processed once. This simplifies code and also
makes the DOM cleaner.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">unless</span> binding.keepAttribute
          element.removeAttr(attribute.name)</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Calls the handler function allowing the handler to set up the binding.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> binding.name.slice(-<span class="hljs-number">2</span>) <span class="hljs-keyword">is</span> <span class="hljs-string">'-*'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Wildcard bindings get the camelcased name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          attribute.match = attribute.name.replace(binding.name.slice(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>), <span class="hljs-string">''</span>)
          attribute.camel = attribute.match
            .replace <span class="hljs-regexp">/[-_]+(\w)/g</span>, <span class="hljs-function"><span class="hljs-params">(_, char)</span> -&gt;</span> char.toUpperCase()

        result = binding.handler element, attribute, controller</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Stops processing of this element (and its children will be skipped) if the element was removed from the DOM.
This is used for bind-if and bind-each etc.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> node.parentNode <span class="hljs-keyword">isnt</span> parentNode
          processed.pop()
          <span class="hljs-keyword">break</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>If the binding returns false it signifies a new controller has taken over</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> result <span class="hljs-keyword">is</span> <span class="hljs-literal">false</span>
          walker.skip()
          processed.pop()
          <span class="hljs-keyword">break</span>

    element
<span class="hljs-function">

<span class="hljs-title">getBoundAttributes</span> = <span class="hljs-params">(attr)</span> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>If a binding is registered for the exact name or for prefix-* use that</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  binding = Binding.getBinding(attr.name)
  <span class="hljs-keyword">unless</span> binding
    parts = attr.name.split(<span class="hljs-string">'-'</span>)
    <span class="hljs-keyword">while</span> parts.length &gt; <span class="hljs-number">1</span>
      parts.pop()
      <span class="hljs-keyword">break</span> <span class="hljs-keyword">if</span> (binding = Binding.getBinding(parts.join(<span class="hljs-string">'-'</span>) + <span class="hljs-string">'-*'</span>))
  <span class="hljs-keyword">unless</span> binding
    <span class="hljs-keyword">if</span> expression.isInverted attr.value
      binding = Binding.getBinding(<span class="hljs-string">'attr-*'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Cache in an object since attr.value will empty once it is removed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> binding
    <span class="hljs-attribute">binding</span>: binding, <span class="hljs-attribute">name</span>: attr.name, <span class="hljs-attribute">value</span>: attr.value
<span class="hljs-function">
<span class="hljs-title">filterAttributes</span> = <span class="hljs-params">(binding)</span> -&gt;</span> binding
<span class="hljs-function"><span class="hljs-title">sortAttributes</span> = <span class="hljs-params">(a, b)</span> -&gt;</span> b.binding.priority - a.binding.priority
<span class="hljs-function"><span class="hljs-title">bindingSort</span> = <span class="hljs-params">(a, b)</span> -&gt;</span> b.priority - a.priority</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Sets up the binding handlers for this jQuery element and all of its descendants</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>jQuery.fn.bindTo = <span class="hljs-function"><span class="hljs-params">(controller)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> <span class="hljs-keyword">this</span>.length <span class="hljs-keyword">isnt</span> <span class="hljs-number">0</span>
    Binding.process(<span class="hljs-keyword">this</span>, controller)


chip.Binding = Binding




<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Walker</span></span>
  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@root</span>)</span> -&gt;</span>
    <span class="hljs-property">@current</span> = <span class="hljs-literal">null</span></pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>A callback to do additional things when a node and it’s children are done</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">onElementDone</span>: <span class="hljs-function">-&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Get the next element and process it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">next</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-property">@current</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">null</span>
      <span class="hljs-property">@current</span> = <span class="hljs-property">@root</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-property">@current</span> = <span class="hljs-property">@placeholder</span> <span class="hljs-keyword">if</span> <span class="hljs-property">@current</span> <span class="hljs-keyword">isnt</span> <span class="hljs-property">@root</span> <span class="hljs-keyword">and</span> <span class="hljs-property">@current</span>.parentNode <span class="hljs-keyword">is</span> <span class="hljs-literal">null</span>
      <span class="hljs-property">@current</span> = <span class="hljs-property">@traverse</span> <span class="hljs-property">@current</span></pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Save a placeholder for when a node is removed from the DOM so we can continue walking</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> <span class="hljs-property">@current</span>
      <span class="hljs-property">@placeholder</span> =
        <span class="hljs-attribute">parentNode</span>: <span class="hljs-property">@current</span>.parentNode
        <span class="hljs-attribute">nextElementSibling</span>: <span class="hljs-property">@current</span>.nextElementSibling
    <span class="hljs-keyword">else</span>
      <span class="hljs-property">@placeholder</span> = <span class="hljs-literal">null</span>
      <span class="hljs-property">@onElementDone</span> <span class="hljs-property">@root</span>
    <span class="hljs-property">@current</span>

  <span class="hljs-attribute">traverse</span>: <span class="hljs-function"><span class="hljs-params">(node)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> node.nodeType
      child = node.firstElementChild
      <span class="hljs-keyword">return</span> child <span class="hljs-keyword">if</span> child

    <span class="hljs-keyword">while</span> (node <span class="hljs-keyword">isnt</span> <span class="hljs-literal">null</span>)
      <span class="hljs-property">@onElementDone</span> node <span class="hljs-keyword">if</span> node.nodeType
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">if</span> node <span class="hljs-keyword">is</span> <span class="hljs-property">@root</span>
      sibling = node.nextElementSibling
      <span class="hljs-keyword">return</span> sibling <span class="hljs-keyword">if</span> sibling
      node = node.parentNode
    node</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Skip over the current element (don’t walk its children) on next call to next()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">skip</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@current</span> = <span class="hljs-property">@placeholder</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
